
Next:

    Overhaul key system:
        * Change the command message to have a string Data.
        * In JS, convert .which to ASCII, and use a special set of strings for
            other keys ("Left", "Up", "Enter", "LeftShift", etc.).
        * On the server, look up key or string in map.
        * Value has key to press and shift state (neutral, force down, force up).
        - Queue up optional shift force (not shift itself), then key.
        - For key up, queue up key up and neutral shift force.
        - When fetching keyboard memory, check if enough time has gone by (4000 cycles).
        - If yes, dequeue and process key or command.
        - If shift force, record it in global.
        - If key, set/clear bit.
        - Then return actual memory, but override with shift force.
    Keep the last few instructions (from log()) as unformatted lines, and print them
        after a panic.
    Replace NN and N in asm with real number.
    If going too fast, sleep for a bit.
        Make this cumulative so it corrects itself.
    Add NMI.
        Reset button and FDI stuff.
    Fix aspect ratio of display.
        Use CSS?

References:

    Best one:
        http://www.zilog.com/docs/z80/um0080.pdf
    Others:
        http://nemesis.lonestar.org/computers/tandy/software/apps/m4/qd/opcodes.html
        http://wikiti.brandonw.net/index.php?title=Z80_Instruction_Set
        http://clrhome.org/table/
        http://guide.ticalc.org/download/z80.txt
        http://www.trs-80.com/trs80-zaps-internals.htm
